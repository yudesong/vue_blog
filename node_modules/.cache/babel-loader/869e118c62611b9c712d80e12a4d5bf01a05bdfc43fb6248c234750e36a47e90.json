{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport UserLogin from './UserLogin.vue';\nimport UserRegister from './UserRegister.vue';\nimport AdminPanel from './AdminPanel.vue';\nimport ArticleEditor from './ArticleEditor.vue';\nexport default {\n  name: 'BlogMain',\n  components: {\n    UserLogin,\n    UserRegister,\n    AdminPanel,\n    ArticleEditor\n  },\n  props: {\n    // 视图状态\n    isAdminView: {\n      type: Boolean,\n      default: false\n    },\n    currentView: {\n      type: String,\n      default: 'home'\n    },\n    adminTab: {\n      type: String,\n      default: 'articles'\n    },\n    // 认证相关状态\n    isAuthView: {\n      type: Boolean,\n      default: false\n    },\n    currentAuthView: {\n      type: String,\n      default: 'login'\n    },\n    currentUser: {\n      type: Object,\n      default: null\n    },\n    // 数据\n    articles: {\n      type: Array,\n      default: () => []\n    },\n    categories: {\n      type: Array,\n      default: () => []\n    },\n    currentArticle: {\n      type: Object,\n      default: null\n    },\n    relatedArticles: {\n      type: Array,\n      default: () => []\n    },\n    filteredCategory: {\n      type: String,\n      default: null\n    }\n  },\n  data() {\n    return {\n      // 评论相关状态\n      commentContent: '',\n      isSubmittingComment: false,\n      isSubmittingReply: false,\n      replyBoxVisible: {\n        commentId: null,\n        replyTo: null,\n        content: ''\n      },\n      // 编辑文章相关状态\n      showArticleEditor: false,\n      editingArticle: null,\n      // 可用的图标列表\n      availableIcons: ['fa-laptop', 'fa-server', 'fa-database', 'fa-robot', 'fa-paint-brush', 'fa-mobile-alt', 'fa-globe', 'fa-code', 'fa-file-alt', 'fa-chart-bar']\n    };\n  },\n  computed: {\n    // 特色文章\n    featuredArticles() {\n      return this.articles.slice(0, 3);\n    },\n    // 最新文章\n    latestArticles() {\n      return [...this.articles].sort((a, b) => new Date(b.publishedDate) - new Date(a.publishedDate)).slice(0, 4);\n    },\n    // 筛选后的文章\n    filteredArticles() {\n      if (!this.filteredCategory) {\n        return this.articles;\n      }\n      return this.articles.filter(article => article.category === this.filteredCategory);\n    },\n    // 总评论数\n    totalComments() {\n      let count = 0;\n      this.articles.forEach(article => {\n        count += article.commentsCount || 0;\n      });\n      return count;\n    },\n    // 总访问量\n    totalViews() {\n      let count = 0;\n      this.articles.forEach(article => {\n        count += article.views || 0;\n      });\n      return count;\n    }\n  },\n  methods: {\n    // 处理文章保存事件\n    handleSaveArticle(articleData) {\n      // 这里应该调用API保存文章，现在只是模拟\n      this.$emit('saveArticle', articleData);\n      // 保存成功后返回管理界面\n      this.showArticleEditor = false;\n      this.editingArticle = null;\n      this.showAdminView = true;\n    },\n    // 处理分类保存事件\n    handleSaveCategory(categoryData) {\n      // 这里应该调用API保存分类，现在只是模拟\n      this.$emit('saveCategory', categoryData);\n    },\n    // 处理删除确认事件\n    handleConfirmDelete({\n      type,\n      id\n    }) {\n      // 这里应该调用API删除项目，现在只是模拟\n      this.$emit('deleteItem', {\n        type,\n        id\n      });\n    },\n    // 创建新文章\n    createArticle() {\n      this.showArticleEditor = true;\n      this.editingArticle = null;\n      this.showAdminView = false; // 确保不显示管理页面\n    },\n    // 编辑文章\n    editArticle(article) {\n      this.showArticleEditor = true;\n      this.editingArticle = article;\n      this.showAdminView = false; // 确保不显示管理页面\n    },\n    // 取消编辑文章\n    cancelEditArticle() {\n      this.showArticleEditor = false;\n      this.editingArticle = null;\n      this.showAdminView = true; // 确保返回到管理界面\n    },\n    // 获取分类颜色\n    getCategoryColor(category) {\n      const colorMap = {\n        '前端开发': 'bg-blue-500',\n        '后端开发': 'bg-green-500',\n        '数据分析': 'bg-yellow-500',\n        '人工智能': 'bg-purple-500',\n        '设计': 'bg-pink-500',\n        '移动开发': 'bg-red-500'\n      };\n      return colorMap[category] || 'bg-gray-500';\n    },\n    // 提交评论\n    async submitComment() {\n      if (!this.currentUser || !this.commentContent.trim() || this.isSubmittingComment) {\n        return;\n      }\n      this.isSubmittingComment = true;\n      try {\n        const newComment = {\n          content: this.commentContent.trim(),\n          articleId: this.currentArticle.id,\n          author: this.currentUser.username,\n          authorAvatar: this.currentUser.avatar || 'https://picsum.photos/id/64/100/100',\n          timestamp: new Date().toISOString(),\n          likes: 0,\n          isLiked: false,\n          replies: []\n        };\n\n        // 尝试发送到服务器\n        try {\n          const response = await fetch('http://localhost:5000/api/comments', {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json',\n              'Authorization': `Bearer ${this.currentUser.token}`\n            },\n            body: JSON.stringify({\n              article_id: this.currentArticle.id,\n              content: newComment.content\n            })\n          });\n          if (response.ok) {\n            const savedComment = await response.json();\n            // 合并服务器返回的数据和本地数据\n            newComment.id = savedComment.id;\n          }\n        } catch (error) {\n          console.error('Error submitting comment to server:', error);\n          // 如果API调用失败，使用本地生成的ID\n          newComment.id = Date.now();\n        }\n\n        // 更新本地数据并通过事件通知父组件\n        this.$emit('commentSubmitted', newComment);\n        this.commentContent = '';\n\n        // 显示成功通知\n        this.showNotification('评论发表成功！', 'success');\n      } catch (error) {\n        console.error('Error submitting comment:', error);\n        this.showNotification('发表评论失败，请稍后重试', 'error');\n      } finally {\n        this.isSubmittingComment = false;\n      }\n    },\n    // 切换回复框\n    toggleReplyBox(comment, replyTo = null) {\n      if (this.replyBoxVisible.commentId === comment.id && !replyTo) {\n        // 如果已经是当前评论的回复框，则关闭\n        this.cancelReply();\n      } else {\n        // 打开回复框\n        this.replyBoxVisible = {\n          commentId: comment.id,\n          replyTo: replyTo,\n          content: ''\n        };\n      }\n    },\n    // 取消回复\n    cancelReply() {\n      this.replyBoxVisible = {\n        commentId: null,\n        replyTo: null,\n        content: ''\n      };\n    },\n    // 提交回复\n    async submitReply(comment) {\n      if (!this.currentUser || !this.replyBoxVisible.content.trim() || this.isSubmittingReply) {\n        return;\n      }\n      this.isSubmittingReply = true;\n      try {\n        const newReply = {\n          content: this.replyBoxVisible.content.trim(),\n          author: this.currentUser.username,\n          authorAvatar: this.currentUser.avatar || 'https://picsum.photos/id/64/100/100',\n          timestamp: new Date().toISOString(),\n          likes: 0,\n          isLiked: false\n        };\n\n        // 尝试发送到服务器\n        try {\n          const response = await fetch('http://localhost:5000/api/comments', {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json',\n              'Authorization': `Bearer ${this.currentUser.token}`\n            },\n            body: JSON.stringify({\n              article_id: this.currentArticle.id,\n              content: newReply.content,\n              parent_id: comment.id\n            })\n          });\n          if (response.ok) {\n            const savedReply = await response.json();\n            // 合并服务器返回的数据\n            newReply.id = savedReply.id;\n          }\n        } catch (error) {\n          console.error('Error submitting reply to server:', error);\n          // 如果API调用失败，使用本地生成的ID\n          newReply.id = Date.now();\n        }\n\n        // 更新本地数据并通过事件通知父组件\n        this.$emit('replySubmitted', {\n          comment,\n          reply: newReply\n        });\n\n        // 关闭回复框\n        this.cancelReply();\n\n        // 显示成功通知\n        this.showNotification('回复发表成功！', 'success');\n      } catch (error) {\n        console.error('Error submitting reply:', error);\n        this.showNotification('发表回复失败，请稍后重试', 'error');\n      } finally {\n        this.isSubmittingReply = false;\n      }\n    },\n    // 点赞/取消点赞\n    async toggleLike(item, parentComment = null) {\n      try {\n        // 切换本地点赞状态\n        item.isLiked = !item.isLiked;\n        item.likes += item.isLiked ? 1 : -1;\n\n        // 通知父组件更新\n        this.$emit('likeToggled', {\n          item,\n          parentComment\n        });\n\n        // 尝试发送到服务器\n        if (this.currentUser) {\n          try {\n            const response = await fetch(`http://localhost:5000/api/comments/${item.id}/like`, {\n              method: 'POST',\n              headers: {\n                'Content-Type': 'application/json',\n                'Authorization': `Bearer ${this.currentUser.token}`\n              }\n            });\n            if (!response.ok) {\n              // 如果服务器操作失败，恢复本地状态\n              item.isLiked = !item.isLiked;\n              item.likes += item.isLiked ? 1 : -1;\n              throw new Error('Server operation failed');\n            }\n          } catch (error) {\n            console.error('Error toggling like:', error);\n          }\n        } else {\n          // 如果未登录，显示提示\n          this.showNotification('请登录后再进行点赞操作', 'info');\n          // 恢复本地状态\n          item.isLiked = !item.isLiked;\n          item.likes += item.isLiked ? 1 : -1;\n        }\n      } catch (error) {\n        console.error('Error toggling like:', error);\n      }\n    },\n    // 格式化日期\n    formatDate(dateString) {\n      const date = new Date(dateString);\n      return date.toLocaleDateString('zh-CN', {\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric'\n      });\n    },\n    // 格式化相对时间\n    formatRelativeTime(timestamp) {\n      const now = new Date();\n      const past = new Date(timestamp);\n      const diffMs = now - past;\n      const diffMins = Math.floor(diffMs / (1000 * 60));\n      const diffHours = Math.floor(diffMins / 60);\n      const diffDays = Math.floor(diffHours / 24);\n      if (diffMins < 1) {\n        return '刚刚';\n      } else if (diffMins < 60) {\n        return `${diffMins}分钟前`;\n      } else if (diffHours < 24) {\n        return `${diffHours}小时前`;\n      } else if (diffDays < 30) {\n        return `${diffDays}天前`;\n      } else {\n        return this.formatDate(timestamp);\n      }\n    },\n    // 显示通知\n    showNotification(message, type = 'success') {\n      const notification = document.createElement('div');\n      notification.className = 'fixed top-4 right-4 py-3 px-5 rounded-md shadow-lg transform transition-all duration-300 z-50';\n      if (type === 'success') {\n        notification.classList.add('bg-green-500', 'text-white');\n      } else if (type === 'error') {\n        notification.classList.add('bg-red-500', 'text-white');\n      } else if (type === 'info') {\n        notification.classList.add('bg-blue-500', 'text-white');\n      }\n      notification.textContent = message;\n      document.body.appendChild(notification);\n\n      // 3秒后移除通知\n      setTimeout(() => {\n        notification.classList.add('opacity-0', 'translate-y-4');\n        setTimeout(() => {\n          document.body.removeChild(notification);\n        }, 300);\n      }, 3000);\n    }\n  }\n};","map":{"version":3,"names":["UserLogin","UserRegister","AdminPanel","ArticleEditor","name","components","props","isAdminView","type","Boolean","default","currentView","String","adminTab","isAuthView","currentAuthView","currentUser","Object","articles","Array","categories","currentArticle","relatedArticles","filteredCategory","data","commentContent","isSubmittingComment","isSubmittingReply","replyBoxVisible","commentId","replyTo","content","showArticleEditor","editingArticle","availableIcons","computed","featuredArticles","slice","latestArticles","sort","a","b","Date","publishedDate","filteredArticles","filter","article","category","totalComments","count","forEach","commentsCount","totalViews","views","methods","handleSaveArticle","articleData","$emit","showAdminView","handleSaveCategory","categoryData","handleConfirmDelete","id","createArticle","editArticle","cancelEditArticle","getCategoryColor","colorMap","submitComment","trim","newComment","articleId","author","username","authorAvatar","avatar","timestamp","toISOString","likes","isLiked","replies","response","fetch","method","headers","token","body","JSON","stringify","article_id","ok","savedComment","json","error","console","now","showNotification","toggleReplyBox","comment","cancelReply","submitReply","newReply","parent_id","savedReply","reply","toggleLike","item","parentComment","Error","formatDate","dateString","date","toLocaleDateString","year","month","day","formatRelativeTime","past","diffMs","diffMins","Math","floor","diffHours","diffDays","message","notification","document","createElement","className","classList","add","textContent","appendChild","setTimeout","removeChild"],"sources":["/Users/yudesong/Project/Vue/blog/src/components/BlogMain.vue"],"sourcesContent":["<template>\n  <!-- 主内容区 -->\n  <main class=\"container mx-auto px-4 pt-24 pb-16\">\n    <!-- 认证视图 -->\n    <div v-if=\"isAuthView\">\n      <UserLogin v-if=\"currentAuthView === 'login'\" @switchToRegister=\"$emit('switchToAuth', 'register')\" @loginSuccess=\"$emit('loginSuccess')\" />\n      <UserRegister v-if=\"currentAuthView === 'register'\" @switchToLogin=\"$emit('switchToAuth', 'login')\" @registerSuccess=\"$emit('registerSuccess')\" />\n    </div>\n    <!-- 前台视图 -->\n    <div v-else-if=\"!isAdminView\">\n      <!-- 首页视图 -->\n      <div v-if=\"currentView === 'home'\" class=\"space-y-12\">\n        <!-- 英雄区 -->\n        <section class=\"relative rounded-2xl overflow-hidden bg-gradient-to-r from-indigo-600 to-purple-700 text-white shadow-xl\">\n          <div class=\"absolute inset-0 opacity-20\">\n            <div class=\"absolute inset-0 bg-[url('https://picsum.photos/id/1073/1200/400')] bg-cover bg-center\"></div>\n          </div>\n          <div class=\"relative py-16 px-8 md:py-24 md:px-16 max-w-3xl\">\n            <h2 class=\"text-3xl md:text-5xl font-bold mb-4 leading-tight\">分享知识，连接思想</h2>\n            <p class=\"text-lg md:text-xl opacity-90 mb-8\">探索高质量的文章，参与有意义的讨论，发现新的观点和见解</p>\n            <div class=\"flex flex-wrap gap-4\">\n              <a href=\"#\" class=\"bg-white text-indigo-700 hover:bg-gray-100 px-6 py-3 rounded-md font-medium transition-colors\" @click.prevent=\"$emit('switchView', 'articles')\">浏览文章</a>\n              <a href=\"#\" class=\"bg-transparent border-2 border-white text-white hover:bg-white/10 px-6 py-3 rounded-md font-medium transition-colors\">了解更多</a>\n            </div>\n          </div>\n        </section>\n        \n        <!-- 特色文章 -->\n        <section>\n          <div class=\"flex justify-between items-center mb-8\">\n            <h2 class=\"text-2xl font-bold text-gray-800\">特色文章</h2>\n            <a href=\"#\" class=\"text-indigo-600 hover:text-indigo-700 font-medium flex items-center\" @click.prevent=\"$emit('switchView', 'articles')\">\n              查看全部\n              <i class=\"fa fa-arrow-right ml-2\"></i>\n            </a>\n          </div>\n          \n          <div class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8\">\n            <article v-for=\"article in featuredArticles\" :key=\"article.id\" class=\"bg-white rounded-xl overflow-hidden shadow-md hover:shadow-xl transition-shadow duration-300 transform hover:-translate-y-1\">\n              <div class=\"relative h-48 overflow-hidden\">\n                <img :src=\"article.coverImage\" alt=\"Article cover\" class=\"w-full h-full object-cover transition-transform duration-500 hover:scale-110\">\n                <div class=\"absolute top-4 left-4\">\n                  <span :class=\"`px-3 py-1 rounded-full text-xs font-medium text-white ${getCategoryColor(article.category)}`\">\n                    {{ article.category }}\n                  </span>\n                </div>\n              </div>\n              <div class=\"p-6\">\n                <h3 class=\"text-xl font-bold mb-3 hover:text-indigo-600 transition-colors cursor-pointer\">{{ article.title }}</h3>\n                <p class=\"text-gray-600 mb-4 line-clamp-3\">{{ article.summary }}</p>\n                <div class=\"flex justify-between items-center\">\n                  <div class=\"flex items-center\">\n                    <img :src=\"article.authorAvatar\" alt=\"Author\" class=\"w-8 h-8 rounded-full mr-2\">\n                    <span class=\"text-sm text-gray-500\">{{ article.author }}</span>\n                  </div>\n                  <span class=\"text-sm text-gray-500\">{{ formatDate(article.publishedDate) }}</span>\n                </div>\n                <div class=\"mt-4 pt-4 border-t border-gray-100 flex justify-between items-center\">\n                  <button class=\"text-indigo-600 hover:text-indigo-700 font-medium\" @click.prevent=\"$emit('viewArticle', article.id)\">阅读全文</button>\n                  <div class=\"flex items-center space-x-4 text-gray-500\">\n                    <span class=\"flex items-center\"><i class=\"fa fa-comment-o mr-1\"></i> {{ article.commentsCount }}</span>\n                    <span class=\"flex items-center\"><i class=\"fa fa-eye mr-1\"></i> {{ article.views }}</span>\n                  </div>\n                </div>\n              </div>\n            </article>\n          </div>\n        </section>\n        \n        <!-- 分类导航 -->\n        <section class=\"bg-white rounded-xl shadow-md p-8\">\n          <h2 class=\"text-2xl font-bold mb-6\">文章分类</h2>\n          <div class=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4\">\n            <a v-for=\"category in categories\" :key=\"category.id\" href=\"#\" class=\"flex flex-col items-center p-6 rounded-lg border border-gray-100 hover:border-indigo-200 hover:bg-indigo-50 transition-colors group\" @click.prevent=\"$emit('filterArticlesByCategory', category.name)\">\n              <div class=\"w-12 h-12 rounded-full flex items-center justify-center mb-3 bg-indigo-100 text-indigo-600 group-hover:bg-indigo-600 group-hover:text-white transition-colors\">\n                <i :class=\"category.icon + ' text-xl'\"></i>\n              </div>\n              <h3 class=\"font-medium text-center\">{{ category.name }}</h3>\n              <span class=\"text-sm text-gray-500 mt-1\">{{ category.count }} 篇文章</span>\n            </a>\n          </div>\n        </section>\n        \n        <!-- 最新文章 -->\n        <section>\n          <h2 class=\"text-2xl font-bold mb-8\">最新文章</h2>\n          <div class=\"space-y-6\">\n            <div v-for=\"article in latestArticles\" :key=\"article.id\" class=\"bg-white rounded-xl shadow-sm hover:shadow-md transition-shadow p-6 flex flex-col md:flex-row gap-6\">\n              <div class=\"md:w-1/4 lg:w-1/5 relative rounded-lg overflow-hidden\">\n                <img :src=\"article.coverImage\" alt=\"Article cover\" class=\"w-full h-48 object-cover\">\n                <span :class=\"`absolute top-3 left-3 px-3 py-1 rounded-full text-xs font-medium text-white ${getCategoryColor(article.category)}`\">\n                  {{ article.category }}\n                </span>\n              </div>\n              <div class=\"md:w-3/4 lg:w-4/5 flex flex-col\">\n                <h3 class=\"text-xl font-bold mb-2 hover:text-indigo-600 transition-colors cursor-pointer\">{{ article.title }}</h3>\n                <p class=\"text-gray-600 mb-4 flex-grow line-clamp-2\">{{ article.summary }}</p>\n                <div class=\"flex flex-wrap justify-between items-center gap-4\">\n                  <div class=\"flex items-center\">\n                    <img :src=\"article.authorAvatar\" alt=\"Author\" class=\"w-8 h-8 rounded-full mr-2\">\n                    <span class=\"text-sm text-gray-500\">{{ article.author }} · {{ formatDate(article.publishedDate) }}</span>\n                  </div>\n                  <div class=\"flex items-center space-x-4 text-gray-500\">\n                    <span class=\"flex items-center\"><i class=\"fa fa-comment-o mr-1\"></i> {{ article.commentsCount }}</span>\n                    <span class=\"flex items-center\"><i class=\"fa fa-eye mr-1\"></i> {{ article.views }}</span>\n                    <button class=\"text-indigo-600 hover:text-indigo-700 font-medium\" @click.prevent=\"$emit('viewArticle', article.id)\">阅读全文</button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          \n          <div class=\"mt-8 text-center\">\n            <button class=\"bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 px-6 py-3 rounded-md font-medium transition-colors\">\n              加载更多\n              <i class=\"fa fa-refresh ml-2\"></i>\n            </button>\n          </div>\n        </section>\n      </div>\n      \n      <!-- 文章列表视图 -->\n      <div v-if=\"currentView === 'articles'\" class=\"space-y-8\">\n        <div class=\"bg-white rounded-xl shadow-md p-6\">\n          <h2 class=\"text-2xl font-bold mb-6\">所有文章</h2>\n          \n          <!-- 筛选和排序 -->\n          <div class=\"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4\">\n            <div class=\"flex flex-wrap gap-2\">\n              <button class=\"px-4 py-2 rounded-full text-sm bg-indigo-100 text-indigo-700 hover:bg-indigo-200 transition-colors\" @click=\"$emit('clearCategoryFilter')\">全部</button>\n              <button v-for=\"category in categories\" :key=\"category.id\" class=\"px-4 py-2 rounded-full text-sm\" :class=\"filteredCategory === category.name ? 'bg-indigo-600 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\" @click=\"$emit('filterArticlesByCategory', category.name)\">\n                {{ category.name }}\n              </button>\n            </div>\n            \n            <div class=\"relative\">\n              <select class=\"appearance-none bg-gray-100 border-0 pl-4 pr-10 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500\">\n                <option>最新发布</option>\n                <option>最多阅读</option>\n                <option>最多评论</option>\n              </select>\n              <div class=\"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700\">\n                <i class=\"fa fa-chevron-down text-xs\"></i>\n              </div>\n            </div>\n          </div>\n          \n          <!-- 文章网格 -->\n          <div class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            <article v-for=\"article in filteredArticles\" :key=\"article.id\" class=\"bg-white rounded-xl overflow-hidden shadow-sm hover:shadow-md transition-shadow border border-gray-100\">\n              <div class=\"relative h-48 overflow-hidden\">\n                <img :src=\"article.coverImage\" alt=\"Article cover\" class=\"w-full h-full object-cover transition-transform duration-500 hover:scale-110\">\n                <div class=\"absolute top-4 left-4\">\n                  <span :class=\"`px-3 py-1 rounded-full text-xs font-medium text-white ${getCategoryColor(article.category)}`\">\n                    {{ article.category }}\n                  </span>\n                </div>\n              </div>\n              <div class=\"p-5\">\n                <h3 class=\"text-lg font-bold mb-2 hover:text-indigo-600 transition-colors cursor-pointer\">{{ article.title }}</h3>\n                <p class=\"text-gray-600 text-sm mb-3 line-clamp-2\">{{ article.summary }}</p>\n                <div class=\"flex justify-between items-center text-sm text-gray-500\">\n                  <span>{{ formatDate(article.publishedDate) }}</span>\n                  <span class=\"flex items-center\"><i class=\"fa fa-comment-o mr-1\"></i> {{ article.commentsCount }}</span>\n                </div>\n                <button class=\"mt-3 w-full text-center text-indigo-600 hover:text-indigo-700 text-sm font-medium\" @click.prevent=\"$emit('viewArticle', article.id)\">阅读全文</button>\n              </div>\n            </article>\n          </div>\n          \n          <!-- 分页 -->\n          <div class=\"mt-8 flex justify-center\">\n            <nav class=\"inline-flex rounded-md shadow-sm\">\n              <button class=\"px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 rounded-l-md\">\n                <i class=\"fa fa-chevron-left\"></i>\n              </button>\n              <button class=\"px-4 py-2 border-t border-b border-gray-300 bg-indigo-50 text-sm font-medium text-indigo-600\">1</button>\n              <button class=\"px-4 py-2 border-t border-b border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50\">2</button>\n              <button class=\"px-4 py-2 border-t border-b border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50\">3</button>\n              <button class=\"px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 rounded-r-md\">\n                <i class=\"fa fa-chevron-right\"></i>\n              </button>\n            </nav>\n          </div>\n        </div>\n      </div>\n      \n      <!-- 分类视图 -->\n      <div v-if=\"currentView === 'categories'\" class=\"space-y-8\">\n        <div class=\"bg-white rounded-xl shadow-md p-6\">\n          <h2 class=\"text-2xl font-bold mb-6\">文章分类</h2>\n          \n          <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            <div v-for=\"category in categories\" :key=\"category.id\" class=\"flex items-start p-5 rounded-lg border border-gray-100 hover:border-indigo-200 hover:bg-indigo-50 transition-colors group cursor-pointer\" @click=\"$emit('filterArticlesByCategory', category.name)\">\n              <div class=\"w-12 h-12 rounded-full flex items-center justify-center mr-4 bg-indigo-100 text-indigo-600 group-hover:bg-indigo-600 group-hover:text-white transition-colors flex-shrink-0\">\n                <i :class=\"category.icon + ' text-xl'\"></i>\n              </div>\n              <div class=\"flex-grow\">\n                <h3 class=\"font-bold text-lg mb-1\">{{ category.name }}</h3>\n                <p class=\"text-gray-600 text-sm mb-2\">{{ category.description }}</p>\n                <div class=\"flex items-center text-sm text-gray-500\">\n                  <span>{{ category.count }} 篇文章</span>\n                  <span class=\"mx-2\">•</span>\n                  <span>最后更新: {{ category.lastUpdated }}</span>\n                </div>\n              </div>\n              <div class=\"flex-shrink-0 ml-2 text-indigo-600 opacity-0 group-hover:opacity-100 transition-opacity\">\n                <i class=\"fa fa-arrow-right\"></i>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      <!-- 文章详情视图 -->\n      <div v-if=\"currentView === 'articleDetail'\" class=\"space-y-8\">\n        <article class=\"bg-white rounded-xl shadow-md overflow-hidden\">\n          <div class=\"relative h-64 md:h-80 lg:h-96\">\n            <img :src=\"currentArticle?.coverImage\" alt=\"Article cover\" class=\"w-full h-full object-cover\">\n            <div class=\"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent\"></div>\n            <div class=\"absolute bottom-0 left-0 right-0 p-6 md:p-8 text-white\">\n              <span :class=\"`px-3 py-1 rounded-full text-xs font-medium mb-4 inline-block ${getCategoryColor(currentArticle?.category)}`\">\n                {{ currentArticle?.category }}\n              </span>\n              <h1 class=\"text-2xl md:text-3xl lg:text-4xl font-bold mb-3\">{{ currentArticle?.title }}</h1>\n              <div class=\"flex flex-wrap items-center gap-4 text-sm text-white/90\">\n                <div class=\"flex items-center\">\n                  <img :src=\"currentArticle?.authorAvatar\" alt=\"Author\" class=\"w-6 h-6 rounded-full mr-2\">\n                  <span>{{ currentArticle?.author }}</span>\n                </div>\n                <span>{{ currentArticle?.publishedDate && formatDate(currentArticle.publishedDate) }}</span>\n                <span class=\"flex items-center\"><i class=\"fa fa-eye mr-1\"></i> {{ currentArticle?.views }}</span>\n              </div>\n            </div>\n          </div>\n          \n          <div class=\"p-6 md:p-8 lg:p-10\">\n            <div class=\"prose max-w-none\">\n              <div v-html=\"currentArticle?.content\" class=\"article-content space-y-6\"></div>\n            </div>\n            \n            <!-- 标签 -->\n            <div class=\"mt-8 pt-6 border-t border-gray-100\">\n              <div class=\"flex flex-wrap items-center gap-2\">\n                <span class=\"text-gray-500\">标签:</span>\n                <span v-for=\"tag in currentArticle?.tags\" :key=\"tag\" class=\"px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm\">#{{ tag }}</span>\n              </div>\n            </div>\n            \n            <!-- 分享 -->\n            <div class=\"mt-6 flex items-center justify-between\">\n              <div class=\"flex items-center gap-3\">\n                <button class=\"flex items-center gap-1 px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-md text-sm transition-colors\">\n                  <i class=\"fa fa-heart-o text-red-500\"></i>\n                  <span>喜欢 ({{ currentArticle?.likes }})</span>\n                </button>\n                <button class=\"flex items-center gap-1 px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-md text-sm transition-colors\">\n                  <i class=\"fa fa-bookmark-o\"></i>\n                  <span>收藏</span>\n                </button>\n              </div>\n              \n              <div class=\"flex items-center gap-2\">\n                <span class=\"text-sm text-gray-500\">分享:</span>\n                <button class=\"w-8 h-8 rounded-full bg-[#1877F2] flex items-center justify-center text-white hover:bg-[#166FE5] transition-colors\">\n                  <i class=\"fa fa-facebook\"></i>\n                </button>\n                <button class=\"w-8 h-8 rounded-full bg-[#1DA1F2] flex items-center justify-center text-white hover:bg-[#1a91da] transition-colors\">\n                  <i class=\"fa fa-twitter\"></i>\n                </button>\n                <button class=\"w-8 h-8 rounded-full bg-[#25D366] flex items-center justify-center text-white hover:bg-[#22c15c] transition-colors\">\n                  <i class=\"fa fa-whatsapp\"></i>\n                </button>\n                <button class=\"w-8 h-8 rounded-full bg-[#0A66C2] flex items-center justify-center text-white hover:bg-[#095cb5] transition-colors\">\n                  <i class=\"fa fa-linkedin\"></i>\n                </button>\n              </div>\n            </div>\n          </div>\n        </article>\n        \n        <!-- 作者信息 -->\n        <div class=\"bg-white rounded-xl shadow-md p-6 flex flex-col md:flex-row items-center gap-6\">\n          <img :src=\"currentArticle?.authorAvatar\" alt=\"Author\" class=\"w-20 h-20 rounded-full object-cover border-4 border-white shadow-md\">\n          <div class=\"text-center md:text-left\">\n            <h3 class=\"text-xl font-bold mb-1\">{{ currentArticle?.author }}</h3>\n            <p class=\"text-gray-600 mb-3\">{{ currentArticle?.authorBio }}</p>\n            <button class=\"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-md text-sm transition-colors\">\n              关注作者\n            </button>\n          </div>\n        </div>\n        \n        <!-- 评论区 -->\n        <div class=\"bg-white rounded-xl shadow-md p-6\">\n          <h3 class=\"text-xl font-bold mb-6\">评论 ({{ currentArticle?.commentsCount }})</h3>\n          \n          <!-- 评论输入 -->\n          <div class=\"mb-8\">\n            <div class=\"flex gap-4\">\n              <img :src=\"currentUser ? currentUser.avatar : 'https://picsum.photos/id/64/100/100'\" alt=\"Your avatar\" class=\"w-10 h-10 rounded-full\">\n              <div class=\"flex-grow\">\n                <textarea v-model=\"commentContent\" :placeholder=\"currentUser ? '分享你的想法...' : '请登录后发表评论...'\" class=\"w-full border border-gray-300 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 resize-none\" rows=\"3\" :disabled=\"!currentUser || isSubmittingComment\"></textarea>\n                <div class=\"mt-3 flex justify-between items-center\">\n                  <div class=\"flex gap-2\">\n                    <button class=\"w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center text-gray-700 transition-colors\" disabled>\n                      <i class=\"fa fa-image\"></i>\n                    </button>\n                    <button class=\"w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center text-gray-700 transition-colors\" disabled>\n                      <i class=\"fa fa-smile-o\"></i>\n                    </button>\n                  </div>\n                  <div>\n                    <button v-if=\"!currentUser\" class=\"bg-gray-200 text-gray-600 px-4 py-2 rounded-md text-sm transition-colors mr-2\" @click=\"$emit('showAuthView', 'login')\">\n                      登录\n                    </button>\n                    <button :class=\"['px-4 py-2 rounded-md text-sm transition-colors', currentUser && !isSubmittingComment ? 'bg-indigo-600 hover:bg-indigo-700 text-white' : 'bg-gray-200 text-gray-600 cursor-not-allowed']\" @click=\"submitComment\" :disabled=\"!currentUser || isSubmittingComment || !commentContent.trim()\">\n                      {{ isSubmittingComment ? '发表中...' : '发表评论' }}\n                    </button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          \n          <!-- 评论列表 -->\n          <div class=\"space-y-6\">\n            <div v-for=\"comment in currentArticle?.comments\" :key=\"comment.id\" class=\"border-b border-gray-100 pb-6 last:border-0 last:pb-0\">\n              <div class=\"flex gap-4\">\n                <img :src=\"comment.authorAvatar\" alt=\"Comment author\" class=\"w-10 h-10 rounded-full\">\n                <div class=\"flex-grow\">\n                  <div class=\"bg-gray-50 p-4 rounded-lg\">\n                    <div class=\"flex justify-between items-start mb-2\">\n                      <h4 class=\"font-medium\">{{ comment.author }}</h4>\n                      <span class=\"text-xs text-gray-500\">{{ formatRelativeTime(comment.timestamp) }}</span>\n                    </div>\n                    <p class=\"text-gray-700\">{{ comment.content }}</p>\n                  </div>\n                  <div class=\"mt-2 flex items-center gap-4 text-sm\">\n                    <button class=\"text-gray-500 hover:text-indigo-600 transition-colors flex items-center gap-1\" @click=\"toggleLike(comment)\">\n                      <i :class=\"comment.isLiked ? 'fa fa-heart text-red-500' : 'fa fa-heart-o'\"></i>\n                      <span>{{ comment.likes }}</span>\n                    </button>\n                    <button class=\"text-gray-500 hover:text-indigo-600 transition-colors\" @click=\"toggleReplyBox(comment)\">回复</button>\n                  </div>\n                  \n                  <!-- 嵌套回复 -->\n                  <div class=\"mt-4 ml-6 space-y-4\">\n                    <div v-for=\"reply in comment.replies\" :key=\"reply.id\" class=\"flex gap-3\">\n                      <img :src=\"reply.authorAvatar\" alt=\"Reply author\" class=\"w-8 h-8 rounded-full\">\n                      <div class=\"flex-grow\">\n                        <div class=\"bg-gray-50 p-3 rounded-lg text-sm\">\n                          <div class=\"flex justify-between items-start mb-1\">\n                            <h5 class=\"font-medium\">{{ reply.author }}</h5>\n                            <span class=\"text-xs text-gray-500\">{{ formatRelativeTime(reply.timestamp) }}</span>\n                          </div>\n                          <p class=\"text-gray-700\">{{ reply.content }}</p>\n                        </div>\n                        <div class=\"mt-1 flex items-center gap-4 text-xs\">\n                          <button class=\"text-gray-500 hover:text-indigo-600 transition-colors flex items-center gap-1\" @click=\"toggleLike(reply, comment)\">\n                            <i :class=\"reply.isLiked ? 'fa fa-heart text-red-500' : 'fa fa-heart-o'\"></i>\n                            <span>{{ reply.likes }}</span>\n                          </button>\n                          <button class=\"text-gray-500 hover:text-indigo-600 transition-colors\" @click=\"toggleReplyBox(comment, reply)\">回复</button>\n                        </div>\n                      </div>\n                    </div>\n                      \n                    <!-- 回复输入框 -->\n                    <div v-if=\"replyBoxVisible.commentId === comment.id\" class=\"flex gap-3\">\n                      <img :src=\"currentUser ? currentUser.avatar : 'https://picsum.photos/id/64/100/100'\" alt=\"Your avatar\" class=\"w-8 h-8 rounded-full\">\n                      <div class=\"flex-grow\">\n                        <textarea v-model=\"replyBoxVisible.content\" :placeholder=\"replyBoxVisible.replyTo ? `回复 @${replyBoxVisible.replyTo.author}...` : `回复 @${comment.author}...`\" class=\"w-full border border-gray-300 rounded-lg p-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 resize-none\" rows=\"2\" :disabled=\"!currentUser || isSubmittingReply\"></textarea>\n                        <div class=\"mt-2 flex justify-end gap-2\">\n                          <button class=\"px-3 py-1 border border-gray-300 text-gray-700 rounded-md text-sm hover:bg-gray-50 transition-colors\" @click=\"cancelReply\">取消</button>\n                          <button :class=\"['px-3 py-1 rounded-md text-sm transition-colors', currentUser && !isSubmittingReply ? 'bg-indigo-600 text-white hover:bg-indigo-700' : 'bg-gray-200 text-gray-600 cursor-not-allowed']\" @click=\"submitReply(comment)\" :disabled=\"!currentUser || isSubmittingReply || !replyBoxVisible.content.trim()\">\n                            {{ isSubmittingReply ? '回复中...' : '回复' }}\n                          </button>\n                        </div>\n                      </div>\n                    </div>\n                      \n                    <!-- 显示回复按钮 -->\n                    <button v-else class=\"flex items-center text-sm text-indigo-600 hover:text-indigo-700\" @click=\"toggleReplyBox(comment)\">\n                      <i class=\"fa fa-reply mr-1\"></i>\n                      <span>回复 @{{ comment.author }}</span>\n                    </button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          \n          <!-- 加载更多评论 -->\n          <div class=\"mt-6 text-center\">\n            <button class=\"bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 px-4 py-2 rounded-md text-sm font-medium transition-colors\">\n              查看更多评论\n            </button>\n          </div>\n        </div>\n        \n        <!-- 相关文章 -->\n        <div>\n          <h3 class=\"text-xl font-bold mb-6\">相关推荐</h3>\n          <div class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            <article v-for=\"article in relatedArticles\" :key=\"article.id\" class=\"bg-white rounded-xl overflow-hidden shadow-sm hover:shadow-md transition-shadow border border-gray-100\">\n              <div class=\"relative h-40 overflow-hidden\">\n                <img :src=\"article.coverImage\" alt=\"Article cover\" class=\"w-full h-full object-cover transition-transform duration-500 hover:scale-110\">\n              </div>\n              <div class=\"p-4\">\n                <h3 class=\"text-base font-bold mb-2 hover:text-indigo-600 transition-colors cursor-pointer line-clamp-2\">{{ article.title }}</h3>\n                <div class=\"flex justify-between items-center text-xs text-gray-500\">\n                  <span>{{ formatDate(article.publishedDate) }}</span>\n                  <span class=\"flex items-center\"><i class=\"fa fa-comment-o mr-1\"></i> {{ article.commentsCount }}</span>\n                </div>\n              </div>\n            </article>\n          </div>\n        </div>\n      </div>\n    </div>\n    \n    <!-- 管理后台视图 -->\n    <div v-if=\"isAdminView\" class=\"space-y-8\">\n        <AdminPanel \n            :articles=\"articles\" \n            :categories=\"categories\" \n            :available-icons=\"availableIcons\"\n            @save-article=\"handleSaveArticle\"\n            @save-category=\"handleSaveCategory\"\n            @confirm-delete=\"handleConfirmDelete\"\n            @create-article=\"createArticle\"\n            @edit-article=\"editArticle\"\n          />\n      </div>\n      \n      <!-- 独立的文章编辑器页面 -->\n      <div v-if=\"showArticleEditor\" class=\"min-h-screen\">\n        <article-editor\n          :article=\"editingArticle\"\n          :categories=\"categories\"\n          @save=\"handleSaveArticle\"\n          @cancel=\"cancelEditArticle\"\n        />\n      </div>\n  </main>\n</template>\n\n<script>\nimport UserLogin from './UserLogin.vue'\nimport UserRegister from './UserRegister.vue'\nimport AdminPanel from './AdminPanel.vue'\nimport ArticleEditor from './ArticleEditor.vue'\n\nexport default {\n  name: 'BlogMain',\n  components: {\n    UserLogin,\n    UserRegister,\n    AdminPanel,\n    ArticleEditor\n  },\n  props: {\n    // 视图状态\n    isAdminView: {\n      type: Boolean,\n      default: false\n    },\n    currentView: {\n      type: String,\n      default: 'home'\n    },\n    adminTab: {\n      type: String,\n      default: 'articles'\n    },\n    // 认证相关状态\n    isAuthView: {\n      type: Boolean,\n      default: false\n    },\n    currentAuthView: {\n      type: String,\n      default: 'login'\n    },\n    currentUser: {\n      type: Object,\n      default: null\n    },\n    // 数据\n    articles: {\n      type: Array,\n      default: () => []\n    },\n    categories: {\n      type: Array,\n      default: () => []\n    },\n    currentArticle: {\n      type: Object,\n      default: null\n    },\n    relatedArticles: {\n      type: Array,\n      default: () => []\n    },\n    filteredCategory: {\n      type: String,\n      default: null\n    }\n  },\n  data() {\n    return {\n      // 评论相关状态\n      commentContent: '',\n      isSubmittingComment: false,\n      isSubmittingReply: false,\n      replyBoxVisible: { commentId: null, replyTo: null, content: '' },\n      // 编辑文章相关状态\n      showArticleEditor: false,\n      editingArticle: null,\n      // 可用的图标列表\n      availableIcons: [\n        'fa-laptop',\n        'fa-server',\n        'fa-database',\n        'fa-robot',\n        'fa-paint-brush',\n        'fa-mobile-alt',\n        'fa-globe',\n        'fa-code',\n        'fa-file-alt',\n        'fa-chart-bar'\n      ]\n    }\n  },\n  computed: {\n    // 特色文章\n    featuredArticles() {\n      return this.articles.slice(0, 3);\n    },\n    \n    // 最新文章\n    latestArticles() {\n      return [...this.articles].sort((a, b) => new Date(b.publishedDate) - new Date(a.publishedDate)).slice(0, 4);\n    },\n    \n    // 筛选后的文章\n    filteredArticles() {\n      if (!this.filteredCategory) {\n        return this.articles;\n      }\n      return this.articles.filter(article => article.category === this.filteredCategory);\n    },\n    \n    // 总评论数\n    totalComments() {\n      let count = 0;\n      this.articles.forEach(article => {\n        count += article.commentsCount || 0;\n      });\n      return count;\n    },\n    \n    // 总访问量\n    totalViews() {\n      let count = 0;\n      this.articles.forEach(article => {\n        count += article.views || 0;\n      });\n      return count;\n    }\n  },\n  methods: {\n    // 处理文章保存事件\n    handleSaveArticle(articleData) {\n      // 这里应该调用API保存文章，现在只是模拟\n      this.$emit('saveArticle', articleData)\n      // 保存成功后返回管理界面\n      this.showArticleEditor = false\n      this.editingArticle = null\n      this.showAdminView = true\n    },\n    \n    // 处理分类保存事件\n    handleSaveCategory(categoryData) {\n      // 这里应该调用API保存分类，现在只是模拟\n      this.$emit('saveCategory', categoryData)\n    },\n    \n    // 处理删除确认事件\n    handleConfirmDelete({ type, id }) {\n      // 这里应该调用API删除项目，现在只是模拟\n      this.$emit('deleteItem', { type, id })\n    },\n    \n    // 创建新文章\n    createArticle() {\n      this.showArticleEditor = true\n      this.editingArticle = null\n      this.showAdminView = false // 确保不显示管理页面\n    },\n    \n    // 编辑文章\n    editArticle(article) {\n      this.showArticleEditor = true\n      this.editingArticle = article\n      this.showAdminView = false // 确保不显示管理页面\n    },\n    \n    // 取消编辑文章\n    cancelEditArticle() {\n      this.showArticleEditor = false\n      this.editingArticle = null\n      this.showAdminView = true // 确保返回到管理界面\n    },\n      \n      // 获取分类颜色\n    getCategoryColor(category) {\n      const colorMap = {\n        '前端开发': 'bg-blue-500',\n        '后端开发': 'bg-green-500',\n        '数据分析': 'bg-yellow-500',\n        '人工智能': 'bg-purple-500',\n        '设计': 'bg-pink-500',\n        '移动开发': 'bg-red-500'\n      };\n      return colorMap[category] || 'bg-gray-500';\n    },\n    \n    // 提交评论\n    async submitComment() {\n      if (!this.currentUser || !this.commentContent.trim() || this.isSubmittingComment) {\n        return;\n      }\n      \n      this.isSubmittingComment = true;\n      try {\n        const newComment = {\n          content: this.commentContent.trim(),\n          articleId: this.currentArticle.id,\n          author: this.currentUser.username,\n          authorAvatar: this.currentUser.avatar || 'https://picsum.photos/id/64/100/100',\n          timestamp: new Date().toISOString(),\n          likes: 0,\n          isLiked: false,\n          replies: []\n        };\n        \n        // 尝试发送到服务器\n        try {\n          const response = await fetch('http://localhost:5000/api/comments', {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json',\n              'Authorization': `Bearer ${this.currentUser.token}`\n            },\n            body: JSON.stringify({\n              article_id: this.currentArticle.id,\n              content: newComment.content\n            })\n          });\n          \n          if (response.ok) {\n            const savedComment = await response.json();\n            // 合并服务器返回的数据和本地数据\n            newComment.id = savedComment.id;\n          }\n        } catch (error) {\n          console.error('Error submitting comment to server:', error);\n          // 如果API调用失败，使用本地生成的ID\n          newComment.id = Date.now();\n        }\n        \n        // 更新本地数据并通过事件通知父组件\n        this.$emit('commentSubmitted', newComment);\n        this.commentContent = '';\n        \n        // 显示成功通知\n        this.showNotification('评论发表成功！', 'success');\n      } catch (error) {\n        console.error('Error submitting comment:', error);\n        this.showNotification('发表评论失败，请稍后重试', 'error');\n      } finally {\n        this.isSubmittingComment = false;\n      }\n    },\n    \n    // 切换回复框\n    toggleReplyBox(comment, replyTo = null) {\n      if (this.replyBoxVisible.commentId === comment.id && !replyTo) {\n        // 如果已经是当前评论的回复框，则关闭\n        this.cancelReply();\n      } else {\n        // 打开回复框\n        this.replyBoxVisible = {\n          commentId: comment.id,\n          replyTo: replyTo,\n          content: ''\n        };\n      }\n    },\n    \n    // 取消回复\n    cancelReply() {\n      this.replyBoxVisible = { commentId: null, replyTo: null, content: '' };\n    },\n    \n    // 提交回复\n    async submitReply(comment) {\n      if (!this.currentUser || !this.replyBoxVisible.content.trim() || this.isSubmittingReply) {\n        return;\n      }\n      \n      this.isSubmittingReply = true;\n      try {\n        const newReply = {\n          content: this.replyBoxVisible.content.trim(),\n          author: this.currentUser.username,\n          authorAvatar: this.currentUser.avatar || 'https://picsum.photos/id/64/100/100',\n          timestamp: new Date().toISOString(),\n          likes: 0,\n          isLiked: false\n        };\n        \n        // 尝试发送到服务器\n        try {\n          const response = await fetch('http://localhost:5000/api/comments', {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json',\n              'Authorization': `Bearer ${this.currentUser.token}`\n            },\n            body: JSON.stringify({\n              article_id: this.currentArticle.id,\n              content: newReply.content,\n              parent_id: comment.id\n            })\n          });\n          \n          if (response.ok) {\n            const savedReply = await response.json();\n            // 合并服务器返回的数据\n            newReply.id = savedReply.id;\n          }\n        } catch (error) {\n          console.error('Error submitting reply to server:', error);\n          // 如果API调用失败，使用本地生成的ID\n          newReply.id = Date.now();\n        }\n        \n        // 更新本地数据并通过事件通知父组件\n        this.$emit('replySubmitted', { comment, reply: newReply });\n        \n        // 关闭回复框\n        this.cancelReply();\n        \n        // 显示成功通知\n        this.showNotification('回复发表成功！', 'success');\n      } catch (error) {\n        console.error('Error submitting reply:', error);\n        this.showNotification('发表回复失败，请稍后重试', 'error');\n      } finally {\n        this.isSubmittingReply = false;\n      }\n    },\n    \n    // 点赞/取消点赞\n    async toggleLike(item, parentComment = null) {\n      try {\n        // 切换本地点赞状态\n        item.isLiked = !item.isLiked;\n        item.likes += item.isLiked ? 1 : -1;\n        \n        // 通知父组件更新\n        this.$emit('likeToggled', { item, parentComment });\n        \n        // 尝试发送到服务器\n        if (this.currentUser) {\n          try {\n            const response = await fetch(`http://localhost:5000/api/comments/${item.id}/like`, {\n              method: 'POST',\n              headers: {\n                'Content-Type': 'application/json',\n                'Authorization': `Bearer ${this.currentUser.token}`\n              }\n            });\n            \n            if (!response.ok) {\n              // 如果服务器操作失败，恢复本地状态\n              item.isLiked = !item.isLiked;\n              item.likes += item.isLiked ? 1 : -1;\n              throw new Error('Server operation failed');\n            }\n          } catch (error) {\n            console.error('Error toggling like:', error);\n          }\n        } else {\n          // 如果未登录，显示提示\n          this.showNotification('请登录后再进行点赞操作', 'info');\n          // 恢复本地状态\n          item.isLiked = !item.isLiked;\n          item.likes += item.isLiked ? 1 : -1;\n        }\n      } catch (error) {\n        console.error('Error toggling like:', error);\n      }\n    },\n    \n    // 格式化日期\n    formatDate(dateString) {\n      const date = new Date(dateString);\n      return date.toLocaleDateString('zh-CN', { year: 'numeric', month: 'long', day: 'numeric' });\n    },\n    \n    // 格式化相对时间\n    formatRelativeTime(timestamp) {\n      const now = new Date();\n      const past = new Date(timestamp);\n      const diffMs = now - past;\n      const diffMins = Math.floor(diffMs / (1000 * 60));\n      const diffHours = Math.floor(diffMins / 60);\n      const diffDays = Math.floor(diffHours / 24);\n      \n      if (diffMins < 1) {\n        return '刚刚';\n      } else if (diffMins < 60) {\n        return `${diffMins}分钟前`;\n      } else if (diffHours < 24) {\n        return `${diffHours}小时前`;\n      } else if (diffDays < 30) {\n        return `${diffDays}天前`;\n      } else {\n        return this.formatDate(timestamp);\n      }\n    },\n    \n    // 显示通知\n    showNotification(message, type = 'success') {\n      const notification = document.createElement('div');\n      notification.className = 'fixed top-4 right-4 py-3 px-5 rounded-md shadow-lg transform transition-all duration-300 z-50';\n      \n      if (type === 'success') {\n        notification.classList.add('bg-green-500', 'text-white');\n      } else if (type === 'error') {\n        notification.classList.add('bg-red-500', 'text-white');\n      } else if (type === 'info') {\n        notification.classList.add('bg-blue-500', 'text-white');\n      }\n      \n      notification.textContent = message;\n      document.body.appendChild(notification);\n      \n      // 3秒后移除通知\n      setTimeout(() => {\n        notification.classList.add('opacity-0', 'translate-y-4');\n        setTimeout(() => {\n          document.body.removeChild(notification);\n        }, 300);\n      }, 3000);\n    }\n  }\n}\n</script>\n\n<style scoped>\n/* 文章内容样式 */\n.article-content h2 {\n  font-size: 1.5rem;\n  font-weight: bold;\n  margin-top: 1.5rem;\n  margin-bottom: 1rem;\n  color: #1a202c;\n}\n\n.article-content h3 {\n  font-size: 1.25rem;\n  font-weight: bold;\n  margin-top: 1.25rem;\n  margin-bottom: 0.75rem;\n  color: #1a202c;\n}\n\n.article-content p {\n  margin-bottom: 1rem;\n  line-height: 1.6;\n}\n\n.article-content ul {\n  margin-bottom: 1rem;\n  padding-left: 1.5rem;\n  list-style-type: disc;\n}\n\n.article-content li {\n  margin-bottom: 0.5rem;\n}\n\n.article-content pre {\n  background-color: #f7fafc;\n  padding: 1rem;\n  border-radius: 0.375rem;\n  overflow-x: auto;\n  margin-bottom: 1rem;\n}\n\n.article-content code {\n  font-family: 'Fira Code', monospace;\n  font-size: 0.875rem;\n}\n\n/* 评论区域样式 */\n.article-comments {\n  margin-top: 2rem;\n}\n\n.comment-item {\n  transition: transform 0.2s ease, box-shadow 0.2s ease;\n  border-radius: 8px;\n  padding: 1rem;\n  margin-bottom: 1rem;\n  background-color: #ffffff;\n  border: 1px solid #f1f1f1;\n}\n\n.comment-item:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);\n}\n\n.comment-author-avatar {\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n  object-fit: cover;\n}\n\n.comment-content {\n  background-color: #f9fafb;\n  border-radius: 8px;\n  padding: 0.75rem 1rem;\n  font-size: 0.95rem;\n  line-height: 1.6;\n  color: #374151;\n}\n\n.comment-actions {\n  margin-top: 0.5rem;\n}\n\n.comment-actions button {\n  transition: all 0.2s ease;\n  padding: 0.25rem 0.5rem;\n  border-radius: 4px;\n  border: none;\n  background: none;\n  cursor: pointer;\n}\n\n.comment-actions button:hover {\n  background-color: #f3f4f6;\n}\n\n.comment-like-btn i {\n  transition: color 0.2s ease;\n}\n\n.comment-like-btn:hover i {\n  color: #f87171;\n  transform: scale(1.1);\n}\n\n.comment-like-btn.active i {\n  color: #f87171;\n}\n\n.comment-reply-btn:hover {\n  text-decoration: underline;\n  color: #4f46e5;\n}\n\n.reply-item {\n  transition: transform 0.2s ease, box-shadow 0.2s ease;\n  margin-left: 1.5rem;\n  border-radius: 8px;\n  padding: 0.75rem;\n  background-color: #f9fafb;\n  border: 1px solid #f1f1f1;\n}\n\n.reply-item:hover {\n  transform: translateY(-1px);\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);\n}\n\n.reply-author-avatar {\n  width: 32px;\n  height: 32px;\n  border-radius: 50%;\n  object-fit: cover;\n}\n\n.reply-content {\n  font-size: 0.875rem;\n  line-height: 1.5;\n  color: #374151;\n}\n\n.comment-form textarea,\n.reply-form textarea {\n  transition: border-color 0.2s ease, box-shadow 0.2s ease;\n  font-family: inherit;\n  font-size: 0.95rem;\n  resize: vertical;\n  min-height: 80px;\n}\n\n.comment-form textarea:focus,\n.reply-form textarea:focus {\n  border-color: #4f46e5;\n  box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);\n}\n\n.comment-form textarea:disabled,\n.reply-form textarea:disabled {\n  background-color: #f9fafb;\n  cursor: not-allowed;\n  opacity: 0.7;\n}\n\n.btn-primary {\n  transition: all 0.2s ease;\n}\n\n.btn-primary:hover {\n  transform: translateY(-1px);\n  box-shadow: 0 2px 8px rgba(79, 70, 229, 0.2);\n}\n\n.btn-primary:active {\n  transform: translateY(0);\n}\n\n.btn-secondary {\n  transition: all 0.2s ease;\n}\n\n.btn-secondary:hover {\n  background-color: #f3f4f6;\n}\n\n.not-logged-in-notice {\n  text-align: center;\n  padding: 1.5rem;\n  background-color: #fef3c7;\n  border: 1px solid #fcd34d;\n  border-radius: 8px;\n  color: #92400e;\n  font-size: 0.95rem;\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}